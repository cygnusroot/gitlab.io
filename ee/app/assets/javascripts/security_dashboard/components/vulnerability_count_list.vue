<script>
import { mapGetters, mapState } from 'vuex';
import VulnerabilityCount from './vulnerability_count.vue';
import { CRITICAL, HIGH, MEDIUM, LOW, UNKNOWN } from '../store/modules/vulnerabilities/constants';

const SEVERITIES = [
  CRITICAL,
  HIGH,
  MEDIUM,
  LOW,
  UNKNOWN,
];

export default {
  name: 'VulnerabilityCountList',
  components: {
    VulnerabilityCount,
  },
  computed: {
    ...mapGetters('vulnerabilities', ['vulnerabilitiesCountBySeverity']),
    ...mapState('vulnerabilities', ['isLoadingVulnerabilitiesCount']),
    counts() {
      return SEVERITIES.map(severity => {
        const count = this.vulnerabilitiesCountBySeverity(severity);
        return { severity, count };
      });
    },
  },
};
</script>

<template>
  <div class="vulnerabilities-count-list">
    <div class="row">
      <div
        v-for="count in counts"
        :key="count.severity"
        class="col-md col-sm-6 js-count"
      >
        <vulnerability-count
          :severity="count.severity"
          :count="count.count"
          :is-loading="isLoadingVulnerabilitiesCount"
        />
      </div>
    </div>
  </div>
</template>

<style>
.vulnerabilities-count-list {
  display: block;
  padding: 2.5em 0 1.5em;
  border-bottom: 1px solid #e5e5e5;
  margin-bottom: 3px;
}
</style>

