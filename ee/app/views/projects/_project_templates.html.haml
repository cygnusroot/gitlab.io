- project_template_count = current_user.available_custom_project_templates.count
- group_id = project.group&.id

- if ::Gitlab::CurrentSettings.custom_project_templates_enabled?
  .project-templates-buttons.col-sm-12
    %ul.nav-tabs.nav-links.nav.scrolling-tabs
      %li.built-in-tab
        %a.nav-link.active{ href: "#built-in", data: { toggle: 'tab'} }
          = _('Built-In')
          %span.badge.badge-pill= Gitlab::ProjectTemplate.all.count
      %li.custom-templates-tab
        %a.nav-link{ href: "#custom-templates", data: { toggle: 'tab'} }
          = _('Custom')
          %span.badge.badge-pill= project_template_count
      %li.group-templates-tab
        %a.nav-link{ href: "#group-templates", data: { toggle: 'tab'} }
          = _('Group')
          %span.badge.badge-pill
            = project_templates_from_groups_counter(project.group&.custom_project_templates_group_id)

  .tab-content
    .project-templates-buttons.import-buttons.tab-pane.active#built-in
      = render 'projects/project_templates/built_in_templates'
    .project-templates-buttons.import-buttons.tab-pane#custom-templates{ data: {initial_templates: user_available_templates_path(current_user)} }
      = icon("spin spinner 2x")
    .project-templates-buttons.import-buttons.tab-pane#group-templates{ data: {initial_templates: user_available_templates_path(current_user, scope: 'groups', group_id: group_id)} }
      = icon("spin spinner 2x")

  .project-fields-form
    = render 'projects/project_templates/project_fields_form'
    = f.hidden_field(:use_custom_template, value: false)
    = f.hidden_field(:group_with_project_templates_id, value: nil)
    = render 'projects/new_project_fields', f: f, project_name_id: "template-project-name", hide_init_with_readme: true

- else
  = render_ce 'projects/project_templates', f: f
